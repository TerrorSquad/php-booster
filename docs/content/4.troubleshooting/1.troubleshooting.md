# Troubleshooting

This section covers common issues you might encounter when using the PHP Booster and how to resolve them.

## Integration Issues

### Integration Script Fails

**Problem**: The integration script fails with errors about missing dependencies.

**Solution**: 
1. Ensure you have all required tools installed:
   ```bash
   # Check if curl is available
   which curl
   
   # For DDEV projects, ensure DDEV is running
   ddev status
   ```

2. Run the integration script in verbose mode to see detailed error messages.

### Files Not Created

**Problem**: Expected booster files are not created in your project.

**Solution**:
1. Check that you ran the integration script from your project root
2. Verify you have write permissions in the project directory
3. Check if your project has any conflicting files that might prevent creation

### Permission Errors

**Problem**: Permission denied errors when running integration.

**Solution**:
```bash
# Ensure execute permissions on scripts
chmod +x tools/runner.sh
chmod +x tools/git-hooks/setup.sh

# For DDEV projects
ddev restart
```

## Git Hooks Issues

### Pre-commit Hook Fails

**Problem**: Pre-commit hook fails with "Could not open input file" errors.

**Solution**: This is usually a path resolution issue in DDEV containers.

1. Check that the hook script has correct file paths:
   ```bash
   # Check pre-commit hook
   cat tools/git-hooks/hooks/pre-commit.bash
   
   # Ensure runner script exists
   ls -la tools/runner.sh
   ```

2. For DDEV, restart the container:
   ```bash
   ddev restart
   ```

### Branch Name Validation Fails

**Problem**: Valid branch names are rejected or invalid ones are accepted.

**Solution**: Check your branch naming configuration:

1. Review the validation config:
   ```bash
   cat validate-branch-name.config.cjs
   ```

2. Test branch validation manually:
   ```bash
   # Test current branch
   node_modules/.bin/validate-branch-name
   
   # Test specific branch name  
   node_modules/.bin/validate-branch-name -t "feature/PRJ-123-my-feature"
   ```

3. Common valid patterns:
   - `feature/PRJ-123-my-feature`
   - `fix/ERM-456-bug-fix`  
   - `chore/update-docs`

### Commit Message Validation Issues

**Problem**: Commit messages are rejected even when they seem correct.

**Solution**:
1. Ensure you're following Conventional Commits format:
   ```
   type(scope): description
   
   Examples:
   feat: add user authentication
   fix(auth): correct password validation
   chore: update dependencies
   ```

2. Check commitlint configuration:
   ```bash
   cat commitlint.config.ts
   ```

## Tool Integration Issues

### Composer Scripts Not Working

**Problem**: `composer ecs`, `composer phpstan`, etc. commands fail.

**Solution**:
1. Verify tools are installed:
   ```bash
   composer show | grep -E "(phpstan|rector|symplify|psalm)"
   ```

2. For DDEV projects, use DDEV commands:
   ```bash
   ddev composer ecs
   ddev composer phpstan
   ```

3. Check if composer scripts exist:
   ```bash
   cat composer.json | jq '.scripts'
   ```

### ECS/PHPStan Path Issues

**Problem**: Code quality tools can't find files or have path resolution errors.

**Solution**: This often happens with DDEV containerization.

1. Use the runner script:
   ```bash
   # Instead of direct tool calls
   bash tools/runner.sh vendor/bin/ecs check src/
   
   # Use composer scripts (recommended)
   ddev composer ecs
   ```

2. Check tool configurations have correct paths:
   ```bash
   # Check ECS config
   cat ecs.php
   
   # Check PHPStan config  
   cat phpstan.neon.dist
   ```

## DDEV Issues

### Container Not Starting

**Problem**: DDEV containers fail to start or show errors.

**Solution**:
1. Check DDEV status and logs:
   ```bash
   ddev status
   ddev logs
   ```

2. Restart DDEV:
   ```bash
   ddev restart
   ```

3. If containers are corrupted, recreate:
   ```bash
   ddev delete -y
   ddev start
   ```

### Performance Issues

**Problem**: DDEV is slow or unresponsive.

**Solution**:
1. Configure Mutagen for better file sync performance (especially on macOS):
   ```bash
   ddev config --mutagen-enabled
   ddev restart
   ```

2. Exclude unnecessary directories from sync:
   ```yaml
   # In .ddev/config.yaml
   upload_dirs:
     - storage/app/uploads
   ```

## Testing Issues

### Integration Tests Failing

**Problem**: The test script fails when running integration tests.

**Solution**:
1. Check requirements:
   ```bash
   ./tools/internal-test/test-integration.py env-check
   ```

2. Clean test environment:
   ```bash
   ./tools/internal-test/test-integration.py clean
   ```

3. Run individual test steps to isolate issues:
   ```bash
   # Test setup only
   ./tools/internal-test/test-integration.py setup
   
   # Test integration only
   ./tools/internal-test/test-integration.py integrate
   
   # Check status
   ./tools/internal-test/test-integration.py status
   ```

### Test Environment Cleanup

**Problem**: Test environments are not cleaned up properly.

**Solution**:
```bash
# Automatic cleanup
./tools/internal-test/test-integration.py clean

# Manual cleanup if script fails
cd tests/laravel/test-project && ddev delete -y
rm -rf tests/laravel/test-project
rm -rf tests/symfony/test-project

# Clean Docker resources if needed
docker system prune -f
```

## IDE Configuration Issues

### VSCode Extensions Not Working

**Problem**: Recommended VSCode extensions don't provide expected functionality.

**Solution**:
1. Check extensions are installed:
   ```bash
   code --list-extensions
   ```

2. Install missing extensions:
   ```bash
   # Install from workspace recommendations
   code --install-extension ms-vscode-remote.remote-containers
   code --install-extension DEVSENSE.phptools-vscode
   ```

3. Check extension settings in `.vscode/settings.json`

### PHPStorm Integration Issues  

**Problem**: PHPStorm doesn't recognize the project structure or DDEV.

**Solution**:
1. Install and configure DDEV Integration plugin
2. Set up PHP interpreter to use DDEV:
   - Go to Settings → PHP → Servers
   - Add new server with DDEV configuration
3. Check `.phpstorm` directory configuration files

## Getting Help

If you're still experiencing issues:

1. Check the [GitHub Issues](https://github.com/TerrorSquad/php-booster/issues) for similar problems
2. Run the test script to validate your setup:
   ```bash
   ./tools/internal-test/test-integration.py full
   ```
3. Create a new issue with:
   - Your operating system and PHP version
   - DDEV version (if applicable)
   - Full error output
   - Steps to reproduce the issue

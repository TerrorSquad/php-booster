---
title: Coding Standards
description: Code style and quality standards for PHP Booster
---

# Coding Standards

PHP Booster maintains high code quality standards across all components. This document outlines the conventions and best practices for different parts of the codebase.

## General Principles

1. **Consistency**: Follow existing patterns in the codebase
2. **Clarity**: Write code that is easy to read and understand
3. **Simplicity**: Prefer simple solutions over complex ones
4. **Documentation**: Comment complex logic, not obvious code
5. **Testing**: Test critical paths and edge cases

## PHP Code Standards

### Modern PHP Syntax

PHP Booster promotes modern PHP 8.1+ features:

```php
<?php

declare(strict_types=1);

namespace App\Service;

// ✅ Use typed properties
final class UserService
{
    public function __construct(
        private readonly UserRepository $repository,  // Promoted constructor properties
        private readonly LoggerInterface $logger,
    ) {
    }
    
    // ✅ Use return types
    public function findUser(int $id): ?User
    {
        return $this->repository->find($id);
    }
    
    // ✅ Use nullsafe operator
    public function getUserEmail(int $id): ?string
    {
        return $this->findUser($id)?->getEmail();
    }
    
    // ✅ Use match expressions
    public function getUserRole(User $user): string
    {
        return match ($user->getType()) {
            'admin' => 'Administrator',
            'moderator' => 'Moderator',
            default => 'User',
        };
    }
}
```

### Avoid Deprecated Patterns

```php
// ❌ Avoid old-style constructors
class OldClass
{
    private $dependency;
    
    public function __construct(Dependency $dependency)
    {
        $this->dependency = $dependency;
    }
}

// ✅ Use promoted properties
class ModernClass
{
    public function __construct(
        private readonly Dependency $dependency,
    ) {
    }
}

// ❌ Avoid long array syntax
$array = array('key' => 'value');

// ✅ Use short array syntax
$array = ['key' => 'value'];
```

## Configuration File Standards

### ECS Configuration (ecs.php)

```php
<?php

declare(strict_types=1);

use PhpCsFixer\Fixer\Import\OrderedImportsFixer;
use Symplify\EasyCodingStandard\Config\ECSConfig;

return ECSConfig::configure()
    ->withPaths([
        __DIR__ . '/src',
        __DIR__ . '/tests',
    ])
    ->withPreparedSets(
        psr12: true,
        common: true,
        symplify: true,
    )
    ->withRules([
        OrderedImportsFixer::class,
    ]);
```

### Rector Configuration (rector.php)

```php
<?php

declare(strict_types=1);

use Rector\Config\RectorConfig;
use Rector\Set\ValueObject\LevelSetList;
use Rector\Set\ValueObject\SetList;

return RectorConfig::configure()
    ->withPaths([
        __DIR__ . '/src',
        __DIR__ . '/tests',
    ])
    ->withPhpSets(php81: true)
    ->withPreparedSets(
        deadCode: true,
        codeQuality: true,
        typeDeclarations: true,
    );
```

## Shell Script Standards

### Bash Scripts

```bash
#!/usr/bin/env bash

# Enable strict error handling
set -e  # Exit on error
set -u  # Exit on undefined variable
set -o pipefail  # Exit on pipe failure

# Use meaningful variable names
readonly SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
readonly PROJECT_ROOT="${SCRIPT_DIR}/.."

# Add helper functions
log_info() {
    echo "[INFO] $*"
}

log_error() {
    echo "[ERROR] $*" >&2
}

# Main logic with error handling
main() {
    log_info "Starting process..."
    
    if [[ ! -d "${PROJECT_ROOT}" ]]; then
        log_error "Project root not found"
        exit 1
    fi
    
    # ... rest of logic
    
    log_info "Process completed successfully"
}

# Call main function
main "$@"
```

### Best Practices

- Always use `set -e` for error handling
- Quote variables: `"${variable}"` not `$variable`
- Use `readonly` for constants
- Check command existence: `command -v tool >/dev/null 2>&1`
- Use `[[ ]]` for conditionals (bash) not `[ ]`
- Add comments for complex logic

## JavaScript/TypeScript Standards (Git Hooks, Tooling)

### ZX Scripts

```javascript
#!/usr/bin/env zx

// ✅ Use ESM imports
import { chalk } from 'zx';
import { getCurrentBranch, success, error } from './shared/utils.mjs';

// ✅ Async/await at top level
const branch = await getCurrentBranch();

// ✅ Use template literals for commands
const result = await $`git log -1 --pretty=%B`;

// ✅ Provide clear error messages
if (!isValidBranch(branch)) {
    error(`Invalid branch name: ${branch}`);
    console.log('Expected format: type/description');
    console.log('Example: feat/add-new-tool');
    process.exit(1);
}

success('Branch name is valid');
```

### TypeScript Configuration

```typescript
// ✅ Use strict mode
// tsconfig.json
{
  "compilerOptions": {
    "strict": true,
    "esModuleInterop": true,
    "moduleResolution": "node",
    "target": "ES2020"
  }
}

// ✅ Type your functions
export async function validateCommitMessage(
    message: string,
    config: CommitlintConfig
): Promise<ValidationResult> {
    // Implementation
}
```

## Documentation Standards

### Markdown Files (Docus Content)

```markdown
---
title: Clear, Descriptive Title
description: Brief description for SEO and navigation
---

# Page Title

Brief introduction paragraph explaining the page's purpose.

## Section Headers

Use hierarchical headers (##, ###, ####) appropriately.

### Code Blocks

Use fenced code blocks with language specification:

```php
<?php

declare(strict_types=1);

// Your code here
```

### Lists

Use lists for enumeration:

- First item
- Second item
  - Nested item
  - Another nested item

### Links

- Internal links: `[Link text](/section/page)` or `[Link text](relative-page)` for same directory
- External links: `[Link text](https://example.com)`

### Admonitions

Use Docus components for callouts:

::alert{type="info"}
This is an informational note.
::

::alert{type="warning"}
This is a warning.
::

::alert{type="danger"}
This is a danger/error message.
::

### Code Examples

Provide complete, runnable examples when possible:

```bash
# Clone repository
git clone https://github.com/TerrorSquad/php-booster.git

# Navigate to project
cd php-booster

# Install dependencies
npm install
```
```

### Frontmatter Requirements

Every documentation file must include:

```yaml
---
title: Page Title (for navigation)
description: SEO-friendly description
navigation: true  # Optional: control navigation visibility
---
```

## Git Standards

### Commit Messages

Follow [Conventional Commits](https://www.conventionalcommits.org/):

```
type(scope): subject

[optional body]

[optional footer]
```

#### Types
- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation
- `style`: Code style (formatting)
- `refactor`: Code refactoring
- `test`: Tests
- `chore`: Maintenance

#### Examples

```
feat(rector): add PHP 8.3 support

Add configuration for PHP 8.3 upgrade rules.

Closes: #123
```

```
fix(git-hooks): handle merge commits correctly

The commit-msg hook was failing on merge commits.
Added check to skip validation for merge commits.
```

```
docs: add ADR for Docus documentation choice
```

### Branch Naming

```
type/description
```

Examples:
- `feat/add-adr-support`
- `fix/branch-validation`
- `docs/update-readme`
- `chore/update-deps`

## Quality Tools Configuration

### PHPStan

```neon
# phpstan.neon.dist
parameters:
    level: max
    paths:
        - src
        - tests
    excludePaths:
        - tests/fixtures
```

### Psalm

```xml
<?xml version="1.0"?>
<psalm
    errorLevel="3"
    resolveFromConfigFile="true"
>
    <projectFiles>
        <directory name="src" />
        <ignoreFiles>
            <directory name="vendor" />
        </ignoreFiles>
    </projectFiles>
</psalm>
```

## Testing Standards

### Integration Tests

```python
# tests/test-integration.py
import subprocess
import tempfile
import shutil
from pathlib import Path

def test_booster_integration():
    """Test booster integration in clean project"""
    with tempfile.TemporaryDirectory() as tmpdir:
        project_dir = Path(tmpdir) / "test-project"
        project_dir.mkdir()
        
        # Setup test project
        setup_test_project(project_dir)
        
        # Run integration
        result = subprocess.run(
            ["bash", "integrate_booster.sh"],
            cwd=project_dir,
            capture_output=True
        )
        
        assert result.returncode == 0, f"Integration failed: {result.stderr}"
        
        # Verify expected files
        assert (project_dir / "ecs.php").exists()
        assert (project_dir / "rector.php").exists()
```

## File Naming Conventions

- **PHP files**: `PascalCase.php` (classes)
- **Config files**: `kebab-case.php` (ecs.php, rector.php)
- **Shell scripts**: `kebab-case.sh`
- **JavaScript**: `kebab-case.mjs` (ESM modules)
- **Documentation**: `kebab-case.md` with numeric prefixes for ordering
- **ADRs**: `adr-NNNN-title.md` (e.g., `adr-0001-docus-documentation.md`)

## Directory Structure Conventions

```
php-booster/
├── booster/              # Integration files
│   ├── tools/           # Utilities and tools
│   └── .github/         # GitHub Actions templates
├── docs/                # Documentation site
│   └── content/         # Docus content
│       ├── 0.index.md   # Numeric prefixes for ordering
│       ├── 1.guide/
│       └── 2.architecture/
└── tests/               # Test files
```

## Code Review Checklist

When reviewing code, check for:

- [ ] Follows established coding standards
- [ ] Includes appropriate tests
- [ ] Documentation is updated
- [ ] Commit messages follow conventions
- [ ] No commented-out code or debug statements
- [ ] Error handling is appropriate
- [ ] Performance is acceptable
- [ ] Security considerations addressed
- [ ] ADR created for significant decisions

## See Also

- [Development Workflow](/development/workflow)
- [Contributing Guidelines](/contributing/contributing)
- [Architecture Overview](/architecture/overview)
